(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31005,e=>{"use strict";var s=e.i(56);let a=e.i(83668).default.forwardRef(({label:e,error:a,helpText:t,className:r,...l},i)=>(0,s.jsxs)("div",{className:"w-full",children:[e&&(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e,l.required&&(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("input",{ref:i,className:`w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition ${a?"border-red-500":""} ${r||""}`,...l}),a&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:a}),t&&(0,s.jsx)("p",{className:"text-gray-500 text-sm mt-1",children:t})]}));a.displayName="FormInput",e.s(["default",0,a])},63159,e=>{"use strict";var s=e.i(56),a=e.i(18130),t=e.i(4972),r=e.i(83668),l=e.i(42041);let i=(0,l.default)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),n=(0,l.default)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var d=e.i(77181),c=e.i(25978),m=e.i(98269),o=e.i(31005),u=e.i(26371),x=e.i(6591),h=e.i(47142);function p(){let e=(0,c.useRouter)(),{userId:l}=(0,m.useAuth)(),{cart:p,totalPrice:g,clearCart:y}=(0,d.useCart)(),[j,b]=(0,r.useState)("shipping"),[f,N]=(0,r.useState)(!1),[v,w]=(0,r.useState)(!1),[C,k]=(0,r.useState)(null),[q,S]=(0,r.useState)({firstName:"",lastName:"",email:"",phone:"",address:"",city:"",country:"Zimbabwe",postalCode:""}),[L,P]=(0,r.useState)("stripe"),T=p.reduce((e,s)=>e+s.price*s.quantity,0),O=T>50?0:5,E=.08*T,R=T+O+E;(0,r.useEffect)(()=>{l?0===p.length&&e.push("/cart"):e.push("/sign-in")},[l,p.length,e]);let Z=async()=>{N(!0),k(null);try{if(0===p.length){k("Your cart is empty"),N(!1);return}let s={items:p.map(e=>({id:e.id,name:e.name,quantity:e.quantity,price:e.price})),shippingInfo:q,paymentMethod:L,subtotal:T,shipping:O,tax:E,total:R},a=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw Error("Failed to create order");let t=await a.json();t.success?(w(!0),y(),h.toast.success("Order placed successfully! A confirmation email has been sent."),setTimeout(()=>{e.push(`/orders?orderId=${t.data.id}`)},2e3)):k(t.error||"Failed to place order")}catch(s){let e=s instanceof Error?s.message:"Failed to place order";k(e),h.toast.error(e)}finally{N(!1)}};return v?(0,s.jsxs)("main",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:[(0,s.jsx)(a.default,{}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,s.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Order Confirmed!"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"Your order has been placed successfully."}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Redirecting to order tracking..."})]}),(0,s.jsx)(t.default,{})]}):(0,s.jsxs)("main",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(a.default,{}),(0,s.jsx)("div",{className:"pt-24 pb-12 md:pb-16",children:(0,s.jsxs)("div",{className:"container-responsive max-w-4xl",children:[(0,s.jsx)("div",{className:"flex items-center justify-center gap-4 mb-12",children:["shipping","payment","review"].map((e,a,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold ${j===e?"bg-primary text-white":t.indexOf(j)>a?"bg-green-500 text-white":"bg-gray-200 text-gray-600"}`,children:a+1}),(0,s.jsx)("span",{className:"hidden sm:inline capitalize font-medium text-gray-700",children:e}),a<t.length-1&&(0,s.jsx)(i,{className:"w-5 h-5 text-gray-400 hidden sm:block"})]},e))}),C&&(0,s.jsx)(u.default,{message:C,onRetry:()=>k(null)}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,s.jsxs)("div",{className:"lg:col-span-2",children:["shipping"===j&&(0,s.jsxs)("form",{onSubmit:e=>{let s;e.preventDefault(),s=[],q.firstName.trim()||s.push("First name required"),q.lastName.trim()||s.push("Last name required"),q.email.trim()||s.push("Email required"),q.phone.trim()||s.push("Phone number required"),q.address.trim()||s.push("Address required"),q.city.trim()||s.push("City required"),q.postalCode.trim()||s.push("Postal code required"),(!(s.length>0)||(k(s.join(", ")),0))&&(k(null),b("payment"))},className:"bg-white rounded-lg p-6 space-y-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:"Shipping Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(o.default,{label:"First Name",required:!0,value:q.firstName,onChange:e=>S({...q,firstName:e.target.value})}),(0,s.jsx)(o.default,{label:"Last Name",required:!0,value:q.lastName,onChange:e=>S({...q,lastName:e.target.value})})]}),(0,s.jsx)(o.default,{label:"Email",type:"email",required:!0,value:q.email,onChange:e=>S({...q,email:e.target.value})}),(0,s.jsx)(o.default,{label:"Phone Number",type:"tel",required:!0,value:q.phone,onChange:e=>S({...q,phone:e.target.value}),helpText:"Include country code (e.g., +263701234567)"}),(0,s.jsx)(o.default,{label:"Address",required:!0,value:q.address,onChange:e=>S({...q,address:e.target.value})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(o.default,{label:"City",required:!0,value:q.city,onChange:e=>S({...q,city:e.target.value})}),(0,s.jsx)(o.default,{label:"Postal Code",required:!0,value:q.postalCode,onChange:e=>S({...q,postalCode:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),(0,s.jsx)("input",{type:"text",value:q.country,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-600"})]}),(0,s.jsx)("button",{type:"submit",className:"w-full py-3 bg-primary text-white font-semibold rounded-lg hover:bg-primary-dark transition",children:"Continue to Payment"})]}),"payment"===j&&(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),b("review")},className:"bg-white rounded-lg p-6 space-y-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:"Payment Method"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("label",{className:"flex items-center p-4 border-2 border-primary rounded-lg cursor-pointer",children:[(0,s.jsx)("input",{type:"radio",name:"payment",value:"stripe",checked:"stripe"===L,onChange:e=>P(e.target.value),className:"mr-3"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold",children:"Credit/Debit Card (Stripe)"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Secure payment via Stripe"})]})]}),(0,s.jsxs)("label",{className:"flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-gray-300",children:[(0,s.jsx)("input",{type:"radio",name:"payment",value:"bank",checked:"bank"===L,onChange:e=>P(e.target.value),className:"mr-3"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold",children:"Bank Transfer"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Direct bank transfer (Zimbabwe)"})]})]})]}),"stripe"===L&&(0,s.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,s.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,s.jsx)(n,{className:"inline w-4 h-4 mr-2"}),"Your payment is secure and encrypted. Testing mode - use card: 4242 4242 4242 4242"]})}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("button",{type:"button",onClick:()=>b("shipping"),className:"flex-1 py-3 border border-gray-300 font-semibold rounded-lg hover:bg-gray-50",children:"Back"}),(0,s.jsx)("button",{type:"submit",className:"flex-1 py-3 bg-primary text-white font-semibold rounded-lg hover:bg-primary-dark transition",children:"Review Order"})]})]}),"review"===j&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-bold",children:"Shipping Address"}),(0,s.jsx)("button",{onClick:()=>b("shipping"),className:"text-primary hover:text-primary-dark text-sm",children:"Edit"})]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[q.firstName," ",q.lastName,(0,s.jsx)("br",{}),q.address,(0,s.jsx)("br",{}),q.city,", ",q.postalCode,(0,s.jsx)("br",{}),q.country,(0,s.jsx)("br",{}),q.email," • ",q.phone]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-bold",children:"Payment Method"}),(0,s.jsx)("button",{onClick:()=>b("payment"),className:"text-primary hover:text-primary-dark text-sm",children:"Edit"})]}),(0,s.jsx)("p",{className:"text-gray-700 capitalize",children:L})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Order Items"}),(0,s.jsx)("div",{className:"space-y-3",children:p.map(e=>(0,s.jsxs)("div",{className:"flex justify-between py-2 border-b border-gray-200 last:border-0",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:e.name}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Qty: ",e.quantity]})]}),(0,s.jsx)("p",{className:"font-semibold",children:(0,s.jsx)(x.default,{amount:e.price*e.quantity,currency:"ZWL"})})]},e.id))})]}),(0,s.jsx)("button",{onClick:Z,disabled:f,className:"w-full py-4 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700 transition disabled:bg-gray-400",children:f?(0,s.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,s.jsx)("span",{className:"animate-spin",children:"⟳"})," Processing..."]}):`Place Order - ${(0,s.jsx)(x.default,{amount:R,currency:"ZWL"})}`})]})]}),(0,s.jsx)("div",{className:"lg:sticky lg:top-24 lg:h-fit",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6 space-y-4",children:[(0,s.jsx)("h3",{className:"font-bold text-lg",children:"Order Summary"}),(0,s.jsx)("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:p.map(e=>(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsxs)("span",{className:"text-gray-600",children:[e.name," x ",e.quantity]}),(0,s.jsx)("span",{className:"font-medium",children:(0,s.jsx)(x.default,{amount:e.price*e.quantity,currency:"ZWL"})})]},e.id))}),(0,s.jsxs)("div",{className:"border-t border-gray-200 pt-4 space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Subtotal"}),(0,s.jsx)("span",{children:(0,s.jsx)(x.default,{amount:T,currency:"ZWL"})})]}),(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Shipping"}),(0,s.jsx)("span",{children:0===O?"FREE":(0,s.jsx)(x.default,{amount:O,currency:"ZWL"})})]}),(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Tax (8%)"}),(0,s.jsx)("span",{children:(0,s.jsx)(x.default,{amount:E,currency:"ZWL"})})]})]}),(0,s.jsx)("div",{className:"border-t border-gray-200 pt-4",children:(0,s.jsxs)("div",{className:"flex justify-between font-bold text-lg",children:[(0,s.jsx)("span",{children:"Total"}),(0,s.jsx)("span",{className:"text-primary",children:(0,s.jsx)(x.default,{amount:R,currency:"ZWL"})})]})})]})})]})]})}),(0,s.jsx)(t.default,{})]})}e.s(["default",()=>p],63159)}]);